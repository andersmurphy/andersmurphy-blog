<!DOCTYPE html>
<html data-theme="dark" lang="en"><head><meta charset="UTF-8" /><title>anders murphy</title><meta content="
base-uri    &apos;self&apos;;
form-action &apos;self&apos;;
default-src &apos;none&apos;;
script-src  &apos;self&apos;;
img-src     &apos;self&apos;;
font-src    &apos;self&apos;;
connect-src &apos;self&apos;;
style-src   &apos;self&apos; &apos;unsafe-inline&apos;
" http-equiv="Content-Security-Policy" /><meta content="text/html; charset=UTF-8" http-equiv="content-type" /><link href="/styles.css" rel="stylesheet" type="text/css" /><link href="/assets/favicon.png" rel="shortcut icon" /><meta content="width=device-width, initial-scale=1.0" name="viewport" /><meta content="A blog mostly about software development." name="description" /></head><body><nav class="container"><ul><li><div style="align-items:center;display:flex;"><img alt="portrait" height="40px" src="/assets/avatar.png" style="image-rendering:pixelated;padding:4px;" width="40px" /><h1 style="margin-bottom:0;"><a class="contrast" href="/">anders murphy</a></h1></div></li></ul><ul><li><a aria-label="Github" class="contrast no-chaos" href="https://github.com/andersmurphy"><svg class="icon-github" height="24" viewBox="0 0 496 512" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></li><li><a aria-label="RSS" class="contrast no-chaos" href="/feed.xml"><svg class="bi bi-rss-fill" fill="currentColor" height="24" viewBox="0 0 16 16" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zm1.5 2.5c5.523 0 10 4.477 10 10a1 1 0 1 1-2 0 8 8 0 0 0-8-8 1 1 0 0 1 0-2m0 4a6 6 0 0 1 6 6 1 1 0 1 1-2 0 4 4 0 0 0-4-4 1 1 0 0 1 0-2m.5 7a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3"></path></svg></a></li></ul></nav><div class="container"><div><article><hgroup><h1><a class="contrast" href="/2024/03/04/clojure-the-repl-makes-contributing-to-open-source-easy.html">Clojure: the REPL makes contributing to open source easy</a></h1><p><time datetime="2024-03-04T00:00:00+00:00">04 Mar 2024</time></p></hgroup><hr /><p>Clojure has a great interactive development experience. This makes it surprisingly easy to contribute to open source. It goes something like this: you're using an open source library, you run into a potential bug, you clone the library, you write some code, you evaluate it and you see if the bug is fixed (all without ever having to restart your REPL).</p></article><article><hgroup><h1><a class="contrast" href="/2024/01/03/clojure-clj-kondo-datalog-linting.html">Clojure: clj-kondo datalog linting</a></h1><p><time datetime="2024-01-03T00:00:00+00:00">03 Jan 2024</time></p></hgroup><hr /><p><a href='https://github.com/clj-kondo/clj-kondo'>clj-kondo</a> has had really nice <a href='https://github.com/clj-kondo/clj-kondo/releases/tag/v2019.11.07'>datalog syntax checking</a> for a while. However, on some projects you might have wrapped the underlying datalog  query function <code>q</code> or be using a datalog implementation clj-kondo doesn't know about. Thankfully, it's trivial to add linting support to any implementation of the query function <code>q</code> as long as it conforms to the Datalog dialect of <a href='https://docs.datomic.com/pro/query/query.html'>Datomic</a>.</p></article><article><hgroup><h1><a class="contrast" href="/2023/09/16/clojure-virtual-threads-with-ring-and-jetty.html">Clojure: virtual threads with ring and jetty</a></h1><p><time datetime="2023-09-16T00:00:00+00:00">16 Sep 2023</time></p></hgroup><hr /><p><a href='https://openjdk.org/jeps/425'>Java 19 introduce virtual threads</a> as a preview feature. Virtual threads are lightweight threads that allow you to write server applications in a simple thread-per-request style (as opposed to async style) and still scale with near-optimal hardware utilisation. The thread-per-request approach is generally easier to reason about, maintain and debug than it's asynchronous counterparts. In this post we'll cover configuring <a href='https://github.com/ring-clojure/ring/tree/master/ring-jetty-adapter'>Jetty</a> to make your ring handlers use virtual threads and benchmark it against regular threads to show how it alleviates the need for tuning thread pools.</p></article><article><hgroup><h1><a class="contrast" href="/2023/09/15/clojure-virtual-threads-with-ring-and-http-kit.html">Clojure: virtual threads with ring and http-kit</a></h1><p><time datetime="2023-09-15T00:00:00+00:00">15 Sep 2023</time></p></hgroup><hr /><p><a href='https://openjdk.org/jeps/425'>Java 19 introduce virtual threads</a> as a preview feature. Virtual threads are lightweight threads that allow you to write server applications in a simple thread-per-request style (as opposed to async style) and still scale with near-optimal hardware utilisation. The thread-per-request approach is generally easier to reason about, maintain and debug than it's asynchronous counterparts. In this post we'll cover configuring <a href='https://github.com/http-kit/http-kit'>http-kit</a> to make your ring handlers use virtual threads and benchmark it against regular threads to show how it alleviates the need for tuning thread pools.</p></article><article><hgroup><h1><a class="contrast" href="/2023/09/08/fennel-making-pico-8-games.html">Fennel: making PICO-8 games</a></h1><p><time datetime="2023-09-08T00:00:00+00:00">08 Sep 2023</time></p></hgroup><hr /><p>I recently wrote <a href='https://andersmurphy.itch.io/staglight'>a game jam game</a> for <a href='https://www.lexaloffle.com/pico-8.php'>PICO-8</a> using <a href='https://fennel-lang.org'>Fennel</a>. This post goes over setting up a project to write PICO-8 games in Fennel.</p></article><article><hgroup><h1><a class="contrast" href="/2023/07/16/clojure-sqlite-application-defined-sql-functions-with-jdbc.html">Clojure: SQLite application defined SQL functions with JDBC</a></h1><p><time datetime="2023-07-16T00:00:00+00:00">16 Jul 2023</time></p></hgroup><hr /><p>SQLite provides a convenient interface called <a href='https://www.sqlite.org/appfunc.html'>Application-Defined SQL Functions</a> that lets you create custom SQL functions that call back into your application code to compute their results. This lets us  extend SQLite in Clojure. Want to query with regex or jsonpath? Want custom aggregation functions? Don't want to write C? Don't want to manage different precompiled binaries for different operating systems. No problem Application Defined SQL Functions have you covered. </p></article><article><hgroup><h1><a class="contrast" href="/2023/07/09/sqlite-building-from-source-on-macos.html">SQLite: building from source on macOS</a></h1><p><time datetime="2023-07-09T00:00:00+00:00">09 Jul 2023</time></p></hgroup><hr /><p>I've been playing around with <a href='https://openjdk.org/projects/panama/'>Project Panama</a> to explore building a simpler and lighter SQLite driver to use from Clojure. This required downloading and compiling SQlite from source for macOS/OS X.</p></article><article><hgroup><h1><a class="contrast" href="/2022/06/14/clojure-sending-emails-with-postal-and-gmail-smtp.html">Clojure: sending emails with postal and Gmail SMTP</a></h1><p><time datetime="2022-06-14T00:00:00+00:00">14 Jun 2022</time></p></hgroup><hr /><p>While services like <a href='https://sendgrid.com'>SendGrid</a> are easy to use and offer a plethora of features like bounce and open rate monitoring, they are not the cheapest option. Gmail's SMTP service on the other hand, although not as feature rich, is more affordable. In this post we will cover setting up Gmail SMTP with <a href='https://github.com/drewr/postal'>postal</a>.</p></article><article><hgroup><h1><a class="contrast" href="/2022/05/22/clojure-pretty-print-strings.html">Clojure: pretty print strings</a></h1><p><time datetime="2022-05-22T00:00:00+00:00">22 May 2022</time></p></hgroup><hr /><p><code>clojure.pprint/pprint</code> can be used to print Clojure data structures in a pleasing, easy-to-understand format. However, sometimes you are not printing directly to <code>&#42;out&#42;</code>, for example when using third party logging libraries/services. Thankfully, we can also use <code>clojure.pprint/pprint</code> generate a pretty string by wrapping it in <code>with-out-str</code>.</p></article><article><hgroup><h1><a class="contrast" href="/2022/05/02/clojure-extend-honeysql-to-support-postgres-alter-column-and-add-constraint.html">Clojure: extend honeysql to support postgres 'alter column' and 'add constraint'</a></h1><p><time datetime="2022-05-02T00:00:00+00:00">02 May 2022</time></p></hgroup><hr /><p><a href='https://github.com/seancorfield/honeysql'>Honeysql</a> is an amazing library that lets you write SQL using clojure data structures. This makes SQL much more composable as you no longer need to smash strings together. That being said, when using it with <a href='https://www.postgresql.org/'>postgresql</a> there are some features that don't work out of the box. Thankfully, honeysql is very easy to extend. This post will show you how to add support for <code>alter column</code> and  <code>add constraint</code>.</p></article><article><hgroup><h1><a class="contrast" href="/2022/03/27/clojure-removing-namespace-from-keywords-in-response-middleware.html">Clojure: removing namespace from keywords in response middleware</a></h1><p><time datetime="2022-03-27T00:00:00+00:00">27 Mar 2022</time></p></hgroup><hr /><p>Namespaced keywords let you add a namespace to a keyword <code>:id</code> -> <code>:user/id</code>, this is a really nice feature that prevents collisions when merging two maps. For example merging  <code>{:account/id &quot;foo&quot;}</code> with  <code>{:user/id &quot;bar&quot;}&#41;</code> would give you <code>{:account/id &quot;foo&quot; :user/id &quot;bar&quot;}</code>. This lets you avoid unnecessary data nesting and keep your data flat. However, by the time this data gets to the edge of your system, where it meets something that expects json, you will often want to remove these namespaces. This post shows you how to write a middleware that automates the removal of namespaces from keywords.</p></article><article><hgroup><h1><a class="contrast" href="/2022/03/20/clojure-making-missing-environment-variables-fail-at-compile-time.html">Clojure: making missing environment variables fail at compile time</a></h1><p><time datetime="2022-03-20T00:00:00+00:00">20 Mar 2022</time></p></hgroup><hr /><p>Have you ever deployed something to production only to have it break because of a missing environment variable? You can eliminate this risk with a simple macro.</p></article><article><hgroup><h1><a class="contrast" href="/2022/03/19/heroku-buildpack-for-clojure-tools.html">Heroku: buildpack for Clojure tools</a></h1><p><time datetime="2022-03-19T00:00:00+00:00">19 Mar 2022</time></p></hgroup><hr /><p>Over the past 4 years I've had the fortune of working full time in Clojure. The backend for the <a href='https://apps.apple.com/US/app/id1436692125?mt=8'>Relish</a> mobile app is built in Clojure. It runs on <a href='https://www.heroku.com/home'>Heroku</a> and we use <a href='https://leiningen.org/'>lein</a> as our build tool. This has been a great development experience. But, for the next Clojure project I wanted to try <a href='https://clojure.org/guides/deps_and_cli'>tools.deps</a> and <a href='https://clojure.org/guides/tools_build'>tools.build</a>. Unfortunately, there isn't an official Heroku buildpack and none of the unofficial alternatives were quite what I was looking for. In the end I decided to roll my own to get comfortable with Heroku's build pack API.</p></article><article><hgroup><h1><a class="contrast" href="/2021/12/12/clojure-compiling-java-source-with-tools-build.html">Clojure: compiling java source with tools.build</a></h1><p><time datetime="2021-12-12T00:00:00+00:00">12 Dec 2021</time></p></hgroup><hr /><p>Recently I stumbled over an old Java project from 2011. I wanted to see if I could get it to run. However, the original program had a bunch of IDE related build files that I no longer understood. What if I used Clojure to build the project? The fruit of that journey is covered in this blog post.</p></article><article><hgroup><h1><a class="contrast" href="/2021/12/04/clojure-check-if-instant-happened-today-at-timezone.html">Clojure: check if instant happened today at timezone</a></h1><p><time datetime="2021-12-04T00:00:00+00:00">04 Dec 2021</time></p></hgroup><hr /><p>Say you are making a digital advent calendar app. You want users to get a special reward on the days that they open your app. But only once per day and only on the days they open the app. This sounds straight forward. What about time zones? What about users who open the app on the 1st of December at 23:55 and then on the 2nd of December at 00:03? Time is tricky.</p></article><article><hgroup><h1><a class="contrast" href="/2021/11/30/emacs-the-joy-of-reducing-workflow-friction-with-elisp.html">Emacs: the joy of reducing workflow friction with elisp</a></h1><p><time datetime="2021-11-30T00:00:00+00:00">30 Nov 2021</time></p></hgroup><hr /><p>Emacs is an interactive, self-documenting and extensible elisp interpreter. This makes it surprisingly enjoyable to extend. It goes something like this: you notice some friction when using a command, you use Emacs' self-documenting features to learn about the command, you investigate the source, you write some elisp, you evaluate it and you try the new and improved command out (all without ever having to restart Emacs).</p></article><article><hgroup><h1><a class="contrast" href="/2021/11/14/emacs-building-from-source-on-macos.html">Emacs: building from source on macOS</a></h1><p><time datetime="2021-11-14T00:00:00+00:00">14 Nov 2021</time></p></hgroup><hr /><p>I've always wanted to build Emacs from source as it lets you try new features. Native compilation in particular was something I wanted to explore. Native compilation leverages <code>libgccjit</code> to compile Emacs lisp code to native code making Emacs very snappy.</p></article><article><hgroup><h1><a class="contrast" href="/2021/11/11/clojure-code-highlights-for-this-website.html">Clojure: code highlights for this website</a></h1><p><time datetime="2021-11-11T00:00:00+00:00">11 Nov 2021</time></p></hgroup><hr /><p>When I changed the styling of this website I removed code highlights as part of an exercise in minimalism. Anyway, I recently read this awesome article about writing a <a href='https://blog.michielborkent.nl/writing-clojure-highlighter.html'>Clojure highlighter from scratch in 160 lines</a> which inspired me to add some very basic highlights back to this site. This post is about implementing my own Clojure highlighter from scratch in 8 lines (and a fraction of the functionality).</p></article><article><hgroup><h1><a class="contrast" href="/2021/10/31/clojure-website-link-checker.html">Clojure: website link checker</a></h1><p><time datetime="2021-10-31T00:00:00+00:00">31 Oct 2021</time></p></hgroup><hr /><p>Writing a simple website link checker in Clojure for fun and profit. Clojure has this nifty function called <code>re-seq</code> that returns a lazy sequence of successive matches of a pattern in a string we can combine this with recursion to write a primitive website link checker.</p></article><article><hgroup><h1><a class="contrast" href="/2021/10/30/clojure-map-occurrence.html">Clojure: map-occurrence</a></h1><p><time datetime="2021-10-30T00:00:00+00:00">30 Oct 2021</time></p></hgroup><hr /><p>Sometimes you want behaviour that differs based on the number of times an item has been seen in a sequence. Clojure doesn't come with a function that does this. Before you say "What about <code>frequencies</code>?", <code>frequencies</code> gives you the total number of occurrences in a sequence of items, not the occurrence count.</p></article><article><hgroup><h1><a class="contrast" href="/2021/10/24/clojure-ensuring-multimethods-are-required.html">Clojure: ensuring multimethods are required</a></h1><p><time datetime="2021-10-24T00:00:00+00:00">24 Oct 2021</time></p></hgroup><hr /><p>Multimethods are fantastic. They give you polymorphism without objects or classes (the best part of Object Oriented without the baggage), multiple dispatch, dynamic dispatch and strong decoupling that allows you to extend code without modifying it (<a href='https://en.wikipedia.org/wiki/Open%E2%80%93closed_principle'>open closed principle</a>), this even extends to third party code. This decoupling is so good that it's not unheard of to deploy your system without all the <code>defmethod</code> extensions being required! This post will teach you how to prevent this.</p></article><article><hgroup><h1><a class="contrast" href="/2021/07/18/clojure-destructive-macros.html">Clojure: destructive macros</a></h1><p><time datetime="2021-07-18T00:00:00+00:00">18 Jul 2021</time></p></hgroup><hr /><p>In this post we'll cover writing a macro that supports destructuring and does something with the bindings. More specifically we will write a macro that makes building maps from arbitrary data less verbose.</p></article><article><hgroup><h1><a class="contrast" href="/2021/07/17/clojure-crawling-hackernews-with-re-seq.html">Clojure: crawling Hacker News with re-seq</a></h1><p><time datetime="2021-07-17T00:00:00+00:00">17 Jul 2021</time></p></hgroup><hr /><p>Clojure has this nifty function called <code>re-seq</code> that returns a lazy sequence of successive matches of a pattern in a string.  This is really useful for turning any string into a list of data. Let's use it to crawl Hacker News!</p></article><article><hgroup><h1><a class="contrast" href="/2020/12/30/clojure-cond-merge-revisited.html">Clojure: cond-merge revisited</a></h1><p><time datetime="2020-12-30T00:00:00+00:00">30 Dec 2020</time></p></hgroup><hr /><p>In <a href='https://andersmurphy.com/2020/12/27/clojure-cond-deep-merge-remove-nils-and-the-shape-of-data.html'>this post</a> we created a macro called <code>cond-merge</code> to conditionally associate in values to a map. In this post we will revisit some of the limitations of <code>cond-merge</code> when it comes to nested conditionals and conditionals that return maps that can lead to overwriting data rather than merging data.</p></article><article><hgroup><h1><a class="contrast" href="/2020/12/29/clojure-adding-dissoc-in-to-the-cond-merge-macro.html">Clojure: adding dissoc-in to our cond-merge macro</a></h1><p><time datetime="2020-12-29T00:00:00+00:00">29 Dec 2020</time></p></hgroup><hr /><p>In <a href='https://andersmurphy.com/2020/12/27/clojure-cond-deep-merge-remove-nils-and-the-shape-of-data.html'>the previous post</a> we created a macro called <code>cond-merge</code> to conditionally associate in values to a map. In this post we will cover adding disassociation (removal of items) to this macro.</p></article><article><hgroup><h1><a class="contrast" href="/2020/12/27/clojure-cond-deep-merge-remove-nils-and-the-shape-of-data.html">Clojure: cond->, deep-merge, remove-nils and the shape of data</a></h1><p><time datetime="2020-12-27T00:00:00+00:00">27 Dec 2020</time></p></hgroup><hr /><p>This article will cover various ways of conditionally hydrating/decorating an existing map with additional data. We'll explore different approaches and how they affect readability of the code as well as performance.</p></article><article><hgroup><h1><a class="contrast" href="/2020/12/13/clojure-string-similarity.html">Clojure: string similarity</a></h1><p><time datetime="2020-12-13T00:00:00+00:00">13 Dec 2020</time></p></hgroup><hr /><p>Sometimes you want to compare strings for similarity. To do this we can use <a href='https://en.wikipedia.org/wiki/Cosine_similarity'>cosine similarity</a> to determine how similar two strings are to each other.</p></article><article><hgroup><h1><a class="contrast" href="/2020/11/11/clojure-adding-compile-time-errors-with-macros.html">Clojure: adding compile time errors with macros</a></h1><p><time datetime="2020-11-11T00:00:00+00:00">11 Nov 2020</time></p></hgroup><hr /><p>Clojure is a dynamic language. But, something you might not know is that unlike a lot of other dynamic languages it's not an interpreted language it's actually compiled. Even when programming at the REPL the Java Virtual Machine's (JVM) Just In Time (JIT) compiler compiles Clojure code to byte code before evaluating it. Combining this with macros which are evaluated at compile time allows us to add compile time errors to our code.</p></article><article><hgroup><h1><a class="contrast" href="/2020/10/11/clojure-previous-current-and-next.html">Clojure: previous, current and next</a></h1><p><time datetime="2020-10-11T00:00:00+00:00">11 Oct 2020</time></p></hgroup><hr /><p>This article will cover a common pattern of iterating over a list of items whilst keeping a reference to the previous, current and next item.</p></article><article><hgroup><h1><a class="contrast" href="/2020/09/06/clojure-jdbc-using-any-and-all-as-an-alternative-to-in.html">Clojure: jdbc using any and all as alternatives to in</a></h1><p><time datetime="2020-09-06T00:00:00+00:00">06 Sep 2020</time></p></hgroup><hr /><p><a href='https://github.com/seancorfield/next-jdbc'>next-jdbc</a> uses parameterised queries to prevent SQL Injections. These queries can take parameters by passing question marks (?) in the query and then by replacing each question mark index with required values. However this can make some sql operators more challenging to use programmatically. In particular <code>in&#40;?,?,?&#41;</code>. In this post we cover using <a href='https://www.postgresql.org/'>postgresql</a>'s <code>any&#40;?&#41;</code> and <code>all&#40;?&#41;</code> to get around this.</p></article><article><hgroup><h1><a class="contrast" href="/2020/08/20/emacs-setting-up-apheleia-to-use-zprint.html">Emacs: setting up Apheleia to use Prettier and Zprint</a></h1><p><time datetime="2020-08-20T00:00:00+00:00">20 Aug 2020</time></p></hgroup><hr /><p><a href='https://github.com/raxod502/apheleia'>Apheleia</a> is an awesome Emacs package for formatting code quickly using external command line tools like <code>prettier</code>. Not only is it fast but it also does a great job at maintaining point position relative to its surroundings (which has been one of my minor frustrations with other Emacs formatters). It's also language agnostic so you can use it with any language that has a command line formatting tool. This post will cover setting up apheleia with <a href='https://github.com/prettier/prettier'>prettier</a> (for JavaScript) and <a href='https://github.com/kkinnear/zprint'>zprint</a> (for Clojure).</p></article><article><hgroup><h1><a class="contrast" href="/2020/08/18/homebrew-write-your-own-brew-formula.html">Homebrew: write your own brew formula</a></h1><p><time datetime="2020-08-18T00:00:00+00:00">18 Aug 2020</time></p></hgroup><hr /><p><a href='https://www.graalvm.org/'>GraalVM</a> is a recent development in the Java ecosystem that allows you to generate native binaries for applications that run on the Java Virtual Machine (JVM). One of the main advantages of this is that it gets around the JVMs slow startup time which is a problem for short lived programs that are run often. This has lead to a projects like <a href='https://github.com/kkinnear/zprint/releases/tag/1.0.0'>zprint releasing native binaries</a>. This is great but, it doesn't give you a nice reproducible way to install/manage/uninstall these executables. For that we want a package manager like <a href='https://brew.sh/'>homebrew</a>.</p></article><article><hgroup><h1><a class="contrast" href="/2020/08/16/clojure-code-formatting-pre-commit-hook-with-zprint.html">Clojure: code formatting pre-commit hook with zprint</a></h1><p><time datetime="2020-08-16T00:00:00+00:00">16 Aug 2020</time></p></hgroup><hr /><p>As a codebase and the team working on it grows, it helps to keep the formatting of a project consistent. This makes the code easier to read and removes the need for unnecessary formatting debates on pull requests. One way to achieve this is to add a formatting check to your continuous integration pipeline. The problem with this solution is that it can add unnecessary overhead. You push a commit, the continuous integration job fails due to incorrect formatting, you fix the formatting issue, and push a new commit. Why can't the formatter just fix the issue itself and save you the trouble? This article will cover setting up <a href='https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks'>pre-commit</a> to automatically format Clojure code with <a href='https://github.com/kkinnear/zprint'>zprint</a> to achieve a more streamlined workflow.</p></article><article><hgroup><h1><a class="contrast" href="/2020/03/27/clojure-java-interop-with-bean.html">Clojure: java interop with bean</a></h1><p><time datetime="2020-03-27T00:00:00+00:00">27 Mar 2020</time></p></hgroup><hr /><p>One of the great things with Clojure is that it has fantastic java interop. In this article we explore the <code>bean</code> function and how it makes working with java objects more idiomatic.</p></article><article><hgroup><h1><a class="contrast" href="/2020/03/01/clojure-code-as-data.html">Clojure: code as data</a></h1><p><time datetime="2020-03-01T00:00:00+00:00">01 Mar 2020</time></p></hgroup><hr /><p>In Clojure, the primary representation of code is the S-expression that takes the form of nested sequences (lists and vectors). The majority of Clojure's functions are designed to operate on sequences. As a result, Clojure code can be manipulated using the same functions that are used to manipulate Clojure data. In other words, there is no distinction between code and data. Code is data. This property is known as <a href='https://en.wikipedia.org/wiki/Homoiconicity'>homoiconicity</a>. This article will explore this concept.</p></article><article><hgroup><h1><a class="contrast" href="/2020/02/08/clojure-persistent-rate-limiting.html">Clojure: persistent rate limiting</a></h1><p><time datetime="2020-02-08T00:00:00+00:00">08 Feb 2020</time></p></hgroup><hr /><p>Some business needs require you to limit the number of times you do something. An example of this would be sending a daily email to users. You could achieve this by making sure you run the function only once per day. However, if that function were to crash part way through how would you know which users had already been sent their daily email and which hadn't? Resolving this without sending some users multiple emails could be a large time sink. A more robust solution would be to make the email sending function idempotent; meaning the effects of the function are applied only once per user per day and any additional applications do nothing. This article will explore one approach to solving this problem in Clojure.</p></article><article><hgroup><h1><a class="contrast" href="/2019/12/19/clojure-permutations.html">Clojure: permutations</a></h1><p><time datetime="2019-12-19T00:00:00+00:00">19 Dec 2019</time></p></hgroup><hr /><p>I was solving an <a href='https://adventofcode.com/'>Advent of Code</a> problem and part of the solution required generating all the permutations of a set of numbers. Permutation is the act of arranging the members of a set into different orders. I wanted to write a recursive solution rather than an imperative solution. After some searching I found a <a href='https://en.wikipedia.org/wiki/Scheme_programming_language'>Scheme</a> implementation. As Scheme and Clojure are both dialects of Lisp, translating one into the other wasn't too difficult.</p></article><article><hgroup><h1><a class="contrast" href="/2019/12/07/ruby-functional-programming.html">Ruby: functional programming</a></h1><p><time datetime="2019-12-07T00:00:00+00:00">07 Dec 2019</time></p></hgroup><hr /><p>In one of my previous jobs I worked as a full stack engineer on a codebase with a Ruby backend and a Javascript/React frontend. Having used Clojure a fair bit in my spare time I was keen to code in a functional style. At first glance this seems tricky in Ruby as it doesn't have first class functions.</p></article><article><hgroup><h1><a class="contrast" href="/2019/11/30/clojure-flattening-key-paths.html">Clojure: flattening key paths</a></h1><p><time datetime="2019-11-30T00:00:00+00:00">30 Nov 2019</time></p></hgroup><hr /><p>This article will cover how to flatten the nested key paths of a map in Clojure; turning a nested map like <code>{:a {:b {:c {:d 1} :e 2}}}</code> into a flat map like <code>{:a-b-c-d 1 :a-b-e 2}</code>.</p></article><article><hgroup><h1><a class="contrast" href="/2019/11/17/clojure-manipulating-html-and-xml-with-zippers.html">Clojure: manipulating HTML and XML with zippers</a></h1><p><time datetime="2019-11-17T00:00:00+00:00">17 Nov 2019</time></p></hgroup><hr /><p>Clojure provides a powerful namespace for manipulating HTML/XML called <code>clojure.zip</code>. It uses the concept of functional zipper (see <a href='http://gallium.inria.fr/~huet/PUBLIC/zip.pdf'>Functional Pearls The zipper</a>) to make manipulating hierarchical data structures simple and efficient. This article will cover how to use zippers to manipulate HTML/XML in Clojure.</p></article><article><hgroup><h1><a class="contrast" href="/2019/10/27/clojure-sorting-tuples.html">Clojure: sorting tuples</a></h1><p><time datetime="2019-10-27T00:00:00+00:00">27 Oct 2019</time></p></hgroup><hr /><p>A tuple is a finite ordered sequence of elements. A common use of tuples in Clojure is for representing pairs of data that are related; for example a key and a value when mapping over a map (hashmap/dictionary). That being said, tuples can be of any length and are a common way of representing larger sets of related data in languages that don't use maps as prolifically as Clojure. This articles explores sorting tuples in Clojure.</p></article><article><hgroup><h1><a class="contrast" href="/2019/09/08/clojure-generating-html-and-xml.html">Clojure: generating HTML and XML</a></h1><p><time datetime="2019-09-08T00:00:00+00:00">08 Sep 2019</time></p></hgroup><hr /><p>HTML and XML are ubiquitous, whether it's the pages of a static site or configuration for a logger, being able to programmatically generate these files can be really powerful. This article will cover how to generate HTML and XML files in Clojure.</p></article><article><hgroup><h1><a class="contrast" href="/2019/08/03/clojure-using-java-time-with-jdbc.html">Clojure: using java.time with clojure.java.jdbc</a></h1><p><time datetime="2019-08-03T00:00:00+00:00">03 Aug 2019</time></p></hgroup><hr /><p>Java 8 introduced <code>java.time</code> to replace the existing java representations of time <code>java.util.Date</code>, <code>java.sql.Timestamp</code> etc. There were many problems with this old implementation: it wasn't thread safe, it had a clunky API and no built in representation for timezones. <code>java.time</code> is the successor to the fantastic <code>joda.time</code> project which solves all these problems. So if <code>java.time</code> fixes everything then why this article? Well, <code>java.sql.Timestamp</code> still rears its ugly head at the database layer where it is still the default representation of time in the <code>java.jdbc</code> database drivers. In this article we will cover how to automate the conversion between <code>java.sql.Timestamp</code> and <code>java.time</code> so you never have to deal with <code>java.sql.Timestamp</code> again.</p></article><article><hgroup><h1><a class="contrast" href="/2019/07/14/clojure-connection-pooling-with-hikari-cp.html">Clojure: connection pooling with hikari-cp</a></h1><p><time datetime="2019-07-14T00:00:00+00:00">14 Jul 2019</time></p></hgroup><hr /><p>Connection pooling is a technique for improving app performance. A pool (cache) of reusable connections is maintained meaning when users connect to the database they can reuse an existing connection. When the user finishes using the connection it is placed back in the pool for other users to use. This reduces the overhead of connecting to the database by decreasing network traffic, limiting the cost of creating new connections, and reducing the load on the garbage collector. Effectively improving the responsiveness of your app for any task that requires connecting to the database.</p></article><article><hgroup><h1><a class="contrast" href="/2019/07/02/clojure-emoji-in-strings.html">Clojure: emoji in strings</a></h1><p><time datetime="2019-07-02T00:00:00+00:00">02 Jul 2019</time></p></hgroup><hr /><p>Sometimes your problem domain requires the use of emoji. This article will cover how emoji are represented in Clojure strings.</p></article><article><hgroup><h1><a class="contrast" href="/2019/06/04/clojure-a-debug-macro-for-threading-macros-using-tap.html">Clojure: a debug macro for threading macros using tap></a></h1><p><time datetime="2019-06-04T00:00:00+00:00">04 Jun 2019</time></p></hgroup><hr /><p>This article will cover how to make a debug macro using tap. See <a href='https://andersmurphy.com/2019/06/01/clojure-intro-to-tap-and-accessing-private-vars.html'>this article</a> for an introduction to Clojure 1.10's tap system.</p></article><article><hgroup><h1><a class="contrast" href="/2019/06/01/clojure-intro-to-tap-and-accessing-private-vars.html">Clojure: intro to tap> and accessing private vars</a></h1><p><time datetime="2019-06-01T00:00:00+00:00">01 Jun 2019</time></p></hgroup><hr /><p>Clojure 1.10 introduced a new system called tap. From the release notes: <em>tap is a shared, globally accessible system for distributing a series of informational or diagnostic values to a set of (presumably effectful) handler functions. It can be used as a better debug prn, or for facilities like logging etc.</em></p></article><article><hgroup><h1><a class="contrast" href="/2019/05/25/clojure-sorting-a-sequence-based-on-another-sequence.html">Clojure: sorting a sequence based on another sequence</a></h1><p><time datetime="2019-05-25T00:00:00+00:00">25 May 2019</time></p></hgroup><hr /><p>Sometimes web responses contain an unordered sequence of items along with a separate manifest that specifies the ordering. This article will cover how you can write a function to sort the list of items by the manifest order as well as using <a href='https://clojure.org/guides/spec#_exercise'>Clojure Spec</a> to generate test data to verify its output.</p></article><article><hgroup><h1><a class="contrast" href="/2019/05/18/clojure-personalising-text.html">Clojure: personalising text</a></h1><p><time datetime="2019-05-18T00:00:00+00:00">18 May 2019</time></p></hgroup><hr /><p>Sometimes you want to make a user's experience feel more personal. An easy way to achieve this is by personalising text based content. For example in a text base adventure game you could replace placeholders in the text with information relevant to that particular player such as their name or class. This could help make your game more engaging.</p></article><article><hgroup><h1><a class="contrast" href="/2019/05/04/clojure-case-conversion-and-boundaries.html">Clojure: case conversion and boundaries</a></h1><p><time datetime="2019-05-04T00:00:00+00:00">04 May 2019</time></p></hgroup><hr /><p>Inconsistent case is a problems that tends to come up at application boundaries in your software stack. For example your Clojure codebase might use <code>kebab-case</code> for keywords, whilst your database uses <code>snake&#95;case</code> for column names and your client wants <code>camelCase</code> in its json responses. Often, conventions and/or technical limitations prevent you from simply having a single case throughout your entire stack.</p></article><article><hgroup><h1><a class="contrast" href="/2019/04/05/clojure-contains-and-some.html">Clojure: contains? and some</a></h1><p><time datetime="2019-04-05T00:00:00+00:00">05 Apr 2019</time></p></hgroup><hr /><p>Checking for containment, whether a collection contains an item, is a common task in software development. This post covers the ways you can check for containment in Clojure.</p></article><article><hgroup><h1><a class="contrast" href="/2019/03/09/clojure-sorting.html">Clojure: sorting</a></h1><p><time datetime="2019-03-09T00:00:00+00:00">09 Mar 2019</time></p></hgroup><hr /><p>Sorting collections of items is something that comes up frequently in software development. This post covers the multitude of ways you can sort things in Clojure.</p></article><article><hgroup><h1><a class="contrast" href="/2019/03/08/lisp-1-vs-lisp-2.html">Lisp-1 vs Lisp-2</a></h1><p><time datetime="2019-03-08T00:00:00+00:00">08 Mar 2019</time></p></hgroup><hr /><p>The Lisp family of languages is relatively new to me. I learned both Clojure and Emacs Lisp at the same time, as Emacs is a popular Clojure editor. Learning these two lisps side by side has made me wonder about the subtle differences between the two, in particular how they approach passing functions as arguments to other functions (first class functions). It turns out this boils down to Clojure being a <strong>lisp-1</strong> and Emacs Lisp a <strong>lisp-2</strong>.</p></article><article><hgroup><h1><a class="contrast" href="/2019/02/16/clojure-merging-maps-by-key.html">Clojure: merging maps by key (join)</a></h1><p><time datetime="2019-02-16T00:00:00+00:00">16 Feb 2019</time></p></hgroup><hr /><p>We have two sequences of maps (tables) and we want to merge them on matching keys (relations).</p></article><article><hgroup><h1><a class="contrast" href="/2019/01/15/clojure-string-interpolation.html">Clojure: string interpolation</a></h1><p><time datetime="2019-01-15T00:00:00+00:00">15 Jan 2019</time></p></hgroup><hr /><p>We have a URL with some placeholder values that we want to replace.</p></article><article><hgroup><h1><a class="contrast" href="/2019/01/06/clojure-sending-emails-with-sendgrid.html">Clojure: sending emails with SendGrid</a></h1><p><time datetime="2019-01-06T00:00:00+00:00">06 Jan 2019</time></p></hgroup><hr /><p>Your business needs you to generate an automated email report containing data from your app. In this example we will use the <a href='https://sendgrid.com'>SendGrid</a> web API to email a <code>.csv</code> file.</p></article><article><hgroup><h1><a class="contrast" href="/2018/11/24/clojure-validating-phone-numbers.html">Clojure: validating phone numbers</a></h1><p><time datetime="2018-11-24T00:00:00+00:00">24 Nov 2018</time></p></hgroup><hr /><p>Sometimes you need to validate phone numbers, <a href='https://github.com/googlei18n/libphonenumber/tree/master/java/libphonenumber/src/com/google/i18n/phonenumbers'>googlei18n/libphonenumber</a> is a Java library for doing just that (and more). Thanks to Clojure's great java interop using this library in your project is straightforward.</p></article><article><hgroup><h1><a class="contrast" href="/2018/11/18/clojure-juxt-and-separate.html">Clojure: juxt and separate</a></h1><p><time datetime="2018-11-18T00:00:00+00:00">18 Nov 2018</time></p></hgroup><hr /><p>Juxt is one of those higher-order functions that you never knew you needed. Despite not using it that often I find it can still be surprisingly useful. Let's check out the docs.</p></article><article><hgroup><h1><a class="contrast" href="/2018/11/10/clojure-map-values-and-keys.html">Clojure: map-values and map-keys</a></h1><p><time datetime="2018-11-10T00:00:00+00:00">10 Nov 2018</time></p></hgroup><hr /><p>This post covers some useful Clojure functions for transforming the keys and values of maps.</p></article><article><hgroup><h1><a class="contrast" href="/2018/01/04/desert-island-code-compose-and-pipe.html">Desert island code: compose and pipe</a></h1><p><time datetime="2018-01-04T00:00:00+00:00">04 Jan 2018</time></p></hgroup><hr /><p>You awake a castaway on a desert island. After some time you come across an ancient computation device, the programming of which might hold your salvation!</p></article><article><hgroup><h1><a class="contrast" href="/2018/01/02/desert-island-code-curry.html">Desert island code: curry</a></h1><p><time datetime="2018-01-02T00:00:00+00:00">02 Jan 2018</time></p></hgroup><hr /><p>You awake a castaway on a desert island. After some time you come across an ancient computation device, the programming of which might hold your salvation!</p></article><article><hgroup><h1><a class="contrast" href="/2017/12/28/desert-island-code-reduce-map-and-filter.html">Desert island code: reduce map and filter</a></h1><p><time datetime="2017-12-28T00:00:00+00:00">28 Dec 2017</time></p></hgroup><hr /><p>You awake a castaway on a desert island. After some time you come across an ancient computation device. The programming of which might hold your salvation!</p></article><article><hgroup><h1><a class="contrast" href="/2016/10/08/managing-obfuscation-with-annotations.html">Managing obfuscation with annotations</a></h1><p><time datetime="2016-10-08T00:00:00+00:00">08 Oct 2016</time></p></hgroup><hr /><p>Obfuscation is when you deliberately make source code difficult to read. Often code is obfuscated to conceal its purpose and deter reverse engineering. Most obfuscation tools do this by replacing class, method and field names with gibberish.</p></article><article><hgroup><h1><a class="contrast" href="/2016/05/19/using-proguard-instead-of-multidex.html">Using Proguard instead of multidex</a></h1><p><time datetime="2016-05-19T00:00:00+00:00">19 May 2016</time></p></hgroup><hr /><p>One of the downsides of using MultiDex to overcome "The 65k limit" is that build times can increase significantly. Another option is to use <a href='https://www.guardsquare.com/proguard'>ProGuard</a>. ProGuard overcomes "The 65k limit" by removing unused method references, this can make a big difference if you are using large third party libraries like <a href='https://github.com/google/guava'>Guava</a>. If configured correctly (disabling optimization/obfuscation) ProGuard can have little to no negative <a href='https://image.slidesharecdn.com/jackandjilldroidconlondon2015-160314154239/95/eric-lafortune-the-jack-and-jill-build-system-16-638.jpg?cb=1457972343'>impact on your build times</a> (in the case of larger project it can even decrease build time).</p></article><article><hgroup><h1><a class="contrast" href="/2016/05/17/signing-your-app.html">Signing your app</a></h1><p><time datetime="2016-05-17T00:00:00+00:00">17 May 2016</time></p></hgroup><hr /><p>Android requires that all apps be digitally signed with a certificate before they can be installed. To install a release version of your app on a device it will need to signed. Thankfully signing an app is relatively straightforward.</p></article><article><hgroup><h1><a class="contrast" href="/2015/10/06/introduction-to-kotlin-on-android.html">Introduction to Kotlin on Android</a></h1><p><time datetime="2015-10-06T00:00:00+00:00">06 Oct 2015</time></p></hgroup><hr /><p>Java is a very verbose language. The simplest tasks often require writing a lot of boiler plate code. Arguably, a lot of this code can be generated by IDEs like <a href='https://www.jetbrains.com/idea/'>IntelliJ IDEA</a> or <a href='https://developer.android.com/sdk/index.html?gclid=CPGB_bHzqMgCFSWw2wodRF0JGQ'>Android Studio</a>. Although, this eases the burden on the writer, it doesn't ease it on the reader. As a developer, you spend a lot more of your time reading code than writing it. This is where I find the additional cognitive overhead of boiler plate code has a habit of stymying development.</p></article><article><hgroup><h1><a class="contrast" href="/2015/09/16/setting-up-retrolambda.html">Setting up Retrolambda</a></h1><p><time datetime="2015-09-16T00:00:00+00:00">16 Sep 2015</time></p></hgroup><hr /><p>Java 8 introduces the much awaited <a href='https://docs.oracle.com/javase/tutorial/java/javaOO/lambdaexpressions.html'>lambda expression</a> and <a href='https://docs.oracle.com/javase/tutorial/java/javaOO/methodreferences.html'>method reference</a>. Unfortunately, at the time of writing, Android does not support Java 8. Thankfully, there is a project called <a href='https://github.com/orfjackal/retrolambda'>Retrolambda</a> that allows you to backport lambda expressions and method references to Java 7. As Android uses the <a href='https://gradle.org/'>Gradle</a> build system, this guide will be using the <a href='https://github.com/evant/gradle-retrolambda'>Retrolambda gradle plugin</a> to add Retrolambda to an Android project.</p></article><article><hgroup><h1><a class="contrast" href="/2015/09/10/enabling-multidex-on-android.html">Enabling multidex on Android</a></h1><p><time datetime="2015-09-10T00:00:00+00:00">10 Sep 2015</time></p></hgroup><hr /><p>As the codebase of an Android app continues to grow, it will eventually hit “The 65K limit”. This limit is characterised by the following build error:</p></article><article><hgroup><h1><a class="contrast" href="/2015/09/02/binding-android-views-with-butter-knife.html">Binding Android views with Butter Knife</a></h1><p><time datetime="2015-09-02T00:00:00+00:00">02 Sep 2015</time></p></hgroup><hr /><p>As Android apps get more complex activities tend to get cluttered with calls to <code>findViewById&#40;id&#41;</code>. This unnecessary boilerplate takes time to write and makes code harder to read. <a href='https://github.com/JakeWharton/butterknife'>Butter Knife</a> to the rescue!</p></article><article><hgroup><h1><a class="contrast" href="/2015/08/27/advantages-of-an-android-free-zone.html">Advantages of an Android free zone</a></h1><p><time datetime="2015-08-27T00:00:00+00:00">27 Aug 2015</time></p></hgroup><hr /><p>In Android projects I like to set up an “Android Free Zone”. This is a Java module that doesn’t have any dependencies on the Android libraries. This is where the business logic of the app lives.</p></article></div><footer><p>© 2015-2024 Anders Murphy</p></footer></div></body></html>