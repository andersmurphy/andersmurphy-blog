<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8" /><title>Clojure: emoji in strings</title><meta content="
base-uri    &apos;self&apos;;
form-action &apos;self&apos;;
default-src &apos;none&apos;;
script-src  &apos;self&apos;;
img-src     &apos;self&apos;;
font-src    &apos;self&apos;;
connect-src &apos;self&apos;;
style-src   &apos;self&apos;
" http-equiv="Content-Security-Policy" /><meta content="text/html; charset=UTF-8" http-equiv="content-type" /><link href="/styles.css" rel="stylesheet" type="text/css" /><link href="/assets/apple-touch-icon-precomposed.png" rel="apple-touch-icon-precomposed" sizes="144x144" /><link href="/assets/favicon.ico" rel="shortcut icon" /><meta content="width=device-width, initial-scale=1.0" name="viewport" /><meta content="A blog mostly about software development." name="description" /></head><body><div class="sidebar"><div class="container sidebar-sticky"><div class="sidebar-about"><img alt="portrait" class="portrait" height="120" src="/assets/anderspixel.png" width="60" /><h1><a href="/">Anders Murphy</a></h1><p class="lead">A blog mostly about functional programming</p></div><nav class="sidebar-nav"><a class="sidebar-nav-item" href="https://github.com/andersmurphy">Github</a><a class="sidebar-nav-item" href="https://twitter.com/anders_murphy">Twitter</a><a class="sidebar-nav-item" href="https://uk.linkedin.com/in/anders-murphy-76457b3a">LinkedIn</a><a class="sidebar-nav-item" href="/feed.xml">RSS</a></nav></div></div><div class="content container"><article class="post"><h1 class="post-title">Clojure: emoji in strings</h1><time class="post-date" datetime="2019-07-02T00:00:00+00:00">02 Jul 2019</time><p>Sometimes your problem domain requires the use of emoji. This article will cover how emoji are represented in Clojure strings.</p><h2 id="emoji_literal">Emoji literal</h2><p>We can represent emoji literally by copy pasting the emoji into your source code.</p><pre><code class="clojure">&quot;ðŸ”®&quot;
<span class="dim">
=&gt;</span> &quot;ðŸ”®&quot;
</code></pre><h2 id="using_unicode">Using unicode</h2><p>Another option is to use unicode. Clojure uses Java's string class which unfortunately doesn't have support for unicode literals. Instead we have to write our own function for converting unicode to strings.</p><pre><code class="clojure"><span class="dim">&#40;</span>defn <strong>unicode-&gt;string</strong> &#91;code&#93;
  <span class="dim">&#40;</span>-&gt; <span class="dim">&#40;</span>Character/toChars code<span class="dim">&#41;</span>
      String.<span class="dim">&#41;&#41;</span>

<span class="dim">&#40;</span>unicode-&gt;string 0x1F52E<span class="dim">&#41;</span>
<span class="dim">
=&gt;</span> &quot;ðŸ”®&quot;
</code></pre><h2 id="things_to_watch_out_for">Things to watch out for</h2><p>It's worth bearing in mind that Java uses UTF-16 encoding. This means that unicode characters will use one 16-bit word or two 16-bits words, depending on the character. We can see this by using <code>count</code>.</p><pre><code class="clojure"><span class="dim">&#40;</span>count &quot;ðŸ”®&quot;<span class="dim">&#41;</span>
<span class="dim">
=&gt;</span> 2
</code></pre><p>The string is 2 characters long, even though it consists of only a single emoji. On the other hand 16-bit words mean you cant represent a two word emoji in a single character (char).</p><p>If we get the first or second character of this string we get a <code>?</code>.</p><pre><code class="clojure"><span class="dim">&#40;</span>subs &quot;ðŸ”® Estimating!&quot; 0 1<span class="dim">&#41;</span>
<span class="dim">
=&gt;</span> &quot;?&quot;

<span class="dim">&#40;</span>subs &quot;ðŸ”® Estimating!&quot; 1 2<span class="dim">&#41;</span>
<span class="dim">
=&gt;</span> &quot;?&quot;
</code></pre><p>If we get the first two characters of the string we get the emoji.</p><pre><code class="clojure"><span class="dim">&#40;</span>subs &quot;ðŸ”® Estimating!&quot; 0 2<span class="dim">&#41;</span>
<span class="dim">
=&gt;</span> &quot;ðŸ”®&quot;
</code></pre><p>So keep the above in mind when manipulating strings containing emoji, you can easily get inconsistent/unexpected behaviour.</p><p>This concludes this brief introduction to emoji in Clojure.</p></article><div class="footer"><p>Â© 2015-2024 Anders Murphy</p></div></div></body></html>